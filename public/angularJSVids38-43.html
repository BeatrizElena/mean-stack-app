<!DOCTYPE html>
<html ng-app="myApp"> <!-- created module called "myApp". A controller, written as a JS script, will need to be assigned to it. -->
    <head>
        <title>AngularJS: Controllers, Modules, SPAs, Routes, Templates</title>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script> 
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"/>
        <script src="https://apis.google.com/js/client.js?onload=onClientLoad" type="text/javascript"></script>
        <script src="assets/js/bootstrap-dropdown.js" type="text/javascript"></script>
        <link href="animate.css" rel="stylesheet">
        <!-- Controllers for "myApp" -->
        <script>
            angular.module('myApp', []).controller('MyController', MyController);
            function MyController($scope) {
                $scope.name = 'Bea';
            }

            angular.module('myApp').controller('MyController2', MyController2);
            function MyController2($scope) {
                $scope.rebels = [
                {name: 'Luke Skywalker', profession: 'Jedi', weapon: 'lightsaber', age: 19}, 
                {name: 'Ben Kenobi', profession: 'Jedi', weapon: 'lightsaber', age: 56}, 
                {name: 'Han Solo', profession: 'smuggler', weapon: 'laser blaster', age: 32}, 
                {name: 'Chewbacca', profession: 'pilot', weapon: 'bowcaster', age: 200},
                ];
            }

            angular.module('myApp').controller('MyController3', MyController3);
            function MyController3($scope) {
                $scope.number = 0;
                $scope.increment = function() {
                    $scope.number = $scope.number + 1;
                }

                $scope.decrement = function() {
                    $scope.number = $scope.number - 1;
                }
            }

            angular.module('myApp').controller('MyController4', MyController4);
            function MyController4($scope) {
                $scope.number = 0;
                $scope.increment = function(amount) {
                    $scope.number = $scope.number + amount;
                }

                $scope.decrement = function(amount) {
                    $scope.number = $scope.number - amount;
                }
            }
            
            angular.module('myApp').controller('MyController5', MyController5); 
            function MyController5() {
                var vm = this;
                vm.name = 'Bea';
            }
        </script>
        <style>        
            * {
                box-sizing: border-box;
            }
            body {
                padding: 20px;
                font-family: Arial, Helvetica, sans-serif;
            }
            .jumbotron {
                min-height: 5px;
                padding: 20px;
            }
            h1 {
                font-size: 50px;
                word-break: break-all;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <!-- House page within a Bootstrap Container Fluid Div -->
        <div class="container-fluid">
            <div class="page-header">
                <nav class="navbar navbar-default navbar-fixed-top">
                    <div class="container-fluid">
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="ion-bar"></span>
                            </button>
                            <a class="navbar-brand" href="#" target="_blank">AngularJS</a>
                        </div>
                        <div class="collapse navbar-collapse" id="myNavbar">
                            <ul class="nav navbar-nav navbar-right"><!-- create bookmars for hrefs below  -->
                                <li><a href="#b38">38: Controllers, $scope and controllerAs</a></li>
                                <li><a href="#b39">39: Modules</a></li>
                                <li><a href="#b40">40: Single Page Apps (SPAs), Routes, Templates</a></li>
                                <li><a href="#b41">41: Built-in Services, Application Architecture</a></li>
                                <li><a href="#b42">42: Custom Services, Service vs. Factory</a></li>
                                <li><a href="#b43">43: Custom Filters</a></li>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>
            <div class="main">               
                <div class="jumbotron" ng-controller="MyController">
                    <h2 id="b38">38: Controllers, $scope and controllerAs</h2>
                    <h4>Controllers and $scope</h4>
                    <ul>
                        <li>Controllers are <b>JS Objects</b> that control the data of AngularJS apps and 
                                    are created by a standard JS <b>object constructor</b></li>
                        <li>An AngularJS app is defined by <b>ng-app="myApp" (myApp being any app name) and runs inside an HTML element 
                                    (the <b>div</b> element; for instance).</b> </li>
                        <li>The <b>ng-controller="MyController"</b> attribute is a directive that defines a controller (placed at the div where the app will run). 
                                    <b>MyControler</b> is any name one can give to the attribute and it is a JS script.</li>
                        <li>AngularJS invokes a <b>$scope</b> object; which is an application object that is the owner of application 
                            variables and functions. <b>$scope</b> is the glue between the controller and the view.</li>
                    </ul>
                    <div ng-controller="MyController">
                        <p>The script looks like this:</p>
                        <pre>
                        <code>
                            angular.module('myApp', []).controller('MyController', MyController);
                            function MyController($scope) {
                                $scope.name = 'Bea';
                            }
                        </code>
                    </pre>
                        <p>And it's called within the div with: <code>Hello, {{name} }</code></p>
                        <p>And it outputs:</p>
                        <p>Hello, {{ name }}!</p>
                    </div>

                    <div ng-controller="MyController2">
                        <p>A 2nd controller outputs this: </p>
                        <ul>
                            <li ng-repeat="rebel in rebels">{{ rebel.name }} is a {{ rebel.profession }} fighting with a {{ rebel.weapon }}.</li>
                        </ul>
                    </div>

                    <div ng-controller="MyController3">
                            <p>A 3rd controller lets us work with the following buttons to increase/decrease a number: </p>
                            <p>{{ number }}</p>
                            <p>
                                <button ng-click="increment()">+1</button>
                                <button ng-click="decrement()">-1</button>
                            </p>
                    </div>

                    <div ng-controller="MyController4">
                            <p>A 4th controller is like the 3rd but we increase/decrease a number by 5: </p>
                            <p>{{ number }}</p>
                            <p>
                                <button ng-click="increment(5)">+5</button>
                                <button ng-click="decrement(5)">-5</button>
                            </p>
                    </div>
                    <p>One way to have several controllers within nested divs is to not use <b>$scope</b> and instead have a script and the code within the divs as follows.
                        (I used $scope in my code. Missing brackets were a quick way to not have the code execute and lead to errors in the app.)
                        The code below would output <b>Beatriz Elena</b>.
                    </p>
                    <pre>
                    <code>
                            angular.module('myApp', [])
                            .controller('MyController', MyController)
                            .controller("MySecondController", MySecondController)
                            function MyController() {
                            var vm = this;
                            vm.name = 'Beatriz';
                            }<br>
                            function MySecondController() {
                                var vm = this;
                                vm.name = 'Elena'
                            }

                        div ng-controller="MyController as MyCtrl">                                                 
                                div ng-controller="MySecondController as MySecondCtrl">
                                    {{ MyCtrl.name } } 
                                    {{ MySecondCtrl.name } }
                                /div>
                        </div>
                    </code>
                    </pre>
</div>
                <div class="jumbotron">
                    <h2 id="b39">39: Modules</h2>
                    <p>From this vid on, we'll be writing the modules code in the <b>app.js</b> file and the controller code in the 
                        <b>controller.js</b> and link to the files at the bottom of this HTML file.</p> 
                        <p>controller.js code:</p>
                        <pre>
                        <code ng-non-bindable>
                            angular.module('myApp').controller('MyController', MyController); <br>
                            function MyController() {
                                var vm = this;
                                vm.name = "Bea";
                            }
                        </code><br>
                        </pre>
                        <br><p>html file code and output:
                        <pre>
                        <code ng-non-bindable>
                            div ng-controller="MyController5 as MyCtrl">
                                Hello, {{ MyCtrl.name }}!
                            /div>
                        </code></p>
                        </pre>
                        <div ng-controller="MyController5 as MyCtrl">
                                <p>Hello, {{ MyCtrl.name }}!</p>
                        </div>                   
                </div>

                <div class="jumbotron">
                    <h2 id="b40">40: Single Page Apps (SPAs), Routes, Templates</h2>
                    <h3>Single Page Applications</h3>
                    <p>In SPAs, the user can navigate through the whole app without the page ever refreshing and even though the 
                        URLs are changing, the application itself is not going to be refreshed. What changes in SPAs is parts of the 
                        application. If someone goes to a particular route, then an html page will be loaded into the application and 
                        that's what's going to be displayed.</p>

                    <p>In AngularJS a SPA can be used through routes. The routes map to a URL path and you also specify a controller and the 
                        template for that URL. When the URL changes in the browser, Angular is going to change the controller and the 
                        view templates that is using and it's going to display that.</p>

                    <h4>Steps in Creating a SPA, Using Routes and Templates</h4>
                        <ol>
                            <li>Use the Angular Route library (link to it in the .html file) and then inject the route as a dependency
                                in the <b>app.js</b> file: <code ng-non-bindable>angular.module('myApp', ['ngRoute']);</code></li>
                            <li>Start using the routes by calling the .config() method on the "myApp" module and have it execute 
                                the config function <b>.config(config)</b> which will use the <b>$routeProvider</b>. The $routeProvider allows us 
                                to set up routes for the app.
                                <code ng-non-bindable>angular.module('myApp', ['ngRoute']).config(config);
                                function config($routeProvider) {
                                    $routeProvider.when('/', {
                                        template: 'this is the main page'
                                    }).when('/about', {
                                        template: 'this is the About page'
                                    });
                                } 
                                </code> 
                                The .when() says that when someone goes to this route on my application, then I want them to get the 
                                template we wrote inside each particular route in the function.</li>
                                <li>After writing the config function, we have to tell Angular where to insert the template. For that, 
                                we go the body of our HTML and insert this div with the built-in <b>ng-view</b> directive: 
                                <code ng-non-bindable>div ng-view div</code></li>
                            <li>Modify the .config() method to have the templates refer to other HTML files, rather that to the hard-coded 
                                text we used in Step 2 above.
                                <code ng-non-bindable>angular.module('myApp', ['ngRoute']).config(config);
                                    function config($routeProvider) {
                                        $routeProvider.when('/', {
                                            templateUrl: 'templates/main.html'
                                        }).when('/about', {
                                            templateUrl: 'templates/about.html'
                                        }).otherwise({
                                            redirectTo: '/'
                                        });
                                    } 
                                </code> <br>If we now open the index.html file that requests the template files, browsers will not let us load 
                                    those files because of "cross-origin request" problems with anything that doesn't have http or https protocols. 
                                    To solve this we need to create an HTTP server; from NodeJS or a Simple Server from Python (if Python is installed) 
                                    which is easily setup from the command line with: <b>python -m SimpleHTTPServer 8080</b>. Press Enter 
                                    and "Allow" incoming connections. This sets up a server for all the files contained in the directory 
                                    from which you setup the Simple Server.</li>
                            <li>Write the controllers in the <b>controller.js file: 
                                <code ng-non-bindable> angular.module('myApp').controller('MyController', MyController).controller('AboutController', AboutController); 
                                    
                                    function MyController() {
                                        var vm = this;
                                        vm.name = "Bea";
                                    }
                                   
                                    function AboutController() {
                                        var vm = this;
                                        vm.about = "This is my bio";
                                    }</code></b></li>
                            <li>The main.html and about.html files can be populated with data coming from the controllers.</li>
                            <li>Test in the browser.</li>
                            <li>Be sure that after completing all the .when() functions for existing routes, use the 
                                <b>.otherwise()</b> function to <b>redirectTo</b> to the root of the application or to a separate <b>404</b> template file.</li>
                        </ol>

                </div>

                <div class="jumbotron">
                    <h2 id="b41">41: Built-in Services, Application Architecture (Structure)</h2>
                    <a href="#"><h4>Built-In Services</h4></a>
                    <p>In AngularJS, a service is a function, or object, that is available for, and limited to, your AngularJS application.
                        AngularJS has about 30 built-in services.</p>
                    <h4>Why use Services?</h4>
                    <p>For many services, like the $location service, it seems like you could use objects that are already in the DOM, 
                        like the window.location object, and you could, but it would have some limitations, at least for your AngularJS 
                        application. AngularJS constantly supervises your application, and for it to handle changes and events properly, 
                        it prefers that you use the $location service instead of the window.location object.</p>
                    <ul>
                        <li>One example of a built-in service is the <b>$routeProvider</b> we used in the last section.</li>
                        <li>For this section, we'll be using the <b>$http</b> service, to which we can daisy-chain methods such as 
                            <b>GET</b>. The $http service makes a request to the server, and lets your application handle the response.</li>
                        <li>We'll also use the <b>$routeParams</b>service</li>
                    </ul>
                    <p style="font-size: 90%"><em>The /film/:p route is working but the angular {{ vm.film.title } and 
                        {{ vm.film.overview } } is not. Or is it how I'm trying to access the data returned by my API?</em></p>

                    <a href="#"><h4>Application Architecture</h4></a>
                    <p style="font-size: 90%">Once all the code was written, the last part of the video went over best-practices in terms of how to 
                        organize the code into manageable files, and group those files into separate directories. We separated the 
                        controllers into separate files and created a /main directory and a /film directory.</p>
                </div>

                <div class="jumbotron">
                    <h2 id="b42">42: Custom Services, Service vs. Factory</h2>
                    <p>To create a custom service, connect the custome service to the module. </p>>
                    <p><b>Difference between a service and a factory</b></p>
                    <p><b>.service()</b> is a method on our module that takes a name and a function that defines the service. Once defined, 
                        we can then inject and use that particular service in other components, like controllers, direectives, and filters. To use it, add it as a dependency 
                        in the controller.</p>
                    <p><b>.factory()</b>is also a mthod on our module and it also takes a name and a function that defines the factory. We can then inject it and use it 
                        the same way we use a service.</p>
                    <p>The difference is that a service is a <b>constructor function</b> that gets instantiated when called. A factory is 
                        not a constructor function, it's just a function that gets called. We will be creating factory functions.</p>

                </div>

                <div class="jumbotron">
                    <h2 id="b43">43: Custom Filters</h2>
                    <p>Filters are added to format data. They are added to directives bu using the pipe character <code>|</code>, 
                        followed by a filter.</p>
                </div>
    
                <div class="content">
                    <footer class="footer">
                        <div class="container">
                            <p class="text-muted text-center">
                                <a><img src="hummingbird.png" height="26" alt="hummingbird picture"</a>
                            </p>
                        
                            <p class="text-muted text-center">
                                <small>&copy; 2017 Ortiz Web Development</small>
                            </p>
                        </div>
                    </footer>
                </div>
            </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-route.min.js"></script>
    <script src="app.js"></script>
    <script src="controller.js"></script>
    </body>
</html>
